(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ea4981cc"],{"318e":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-account"},[n("div",{staticClass:"container",class:[e.fullWidth>768?"containerSamll":"containerBig"]},[e.fullWidth>768?n("swiper",{staticClass:"swiperPross",attrs:{options:e.swiperOption}},[e._l(e.swiperList,(function(e,t){return n("swiper-slide",{key:t,staticClass:"swiperPic"},[n("img",{attrs:{src:e.slide}})])})),n("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],2):e._e(),n("div",{staticClass:"index_from page-account-container"},[n("div",{staticClass:"page-account-top "},[n("div",{staticClass:"page-account-top-logo"},[n("img",{attrs:{src:e.login_logo,alt:"logo"}})])]),n("Form",{ref:"formInline",attrs:{model:e.formInline,rules:e.ruleInline},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit("formInline")}}},[n("FormItem",{attrs:{prop:"username"}},[n("Input",{attrs:{type:"text",prefix:"ios-contact-outline",placeholder:"请输入用户名",size:"large"},model:{value:e.formInline.username,callback:function(t){e.$set(e.formInline,"username",t)},expression:"formInline.username"}})],1),n("FormItem",{attrs:{prop:"password"}},[n("Input",{attrs:{type:"password",prefix:"ios-lock-outline",placeholder:"请输入密码",size:"large"},model:{value:e.formInline.password,callback:function(t){e.$set(e.formInline,"password",t)},expression:"formInline.password"}})],1),n("FormItem",{attrs:{prop:"code"}},[n("div",{staticClass:"code"},[n("Input",{attrs:{type:"text",prefix:"ios-keypad-outline",placeholder:"请输入验证码",size:"large"},model:{value:e.formInline.code,callback:function(t){e.$set(e.formInline,"code",t)},expression:"formInline.code"}}),n("img",{staticClass:"pictrue",attrs:{src:e.imgcode},on:{click:e.captchas}})],1)]),n("FormItem",[n("Button",{staticClass:"btn",attrs:{type:"primary",long:"",size:"large"},on:{click:function(t){return e.handleSubmit("formInline")}}},[e._v(e._s(e.$t("page.login.submit"))+"\n                    ")])],1)],1)],1)],1),n("Modal",{attrs:{scrollable:"","footer-hide":"",closable:"",title:"请完成安全校验","mask-closable":!1,"z-index":2,width:"342"},model:{value:e.modals,callback:function(t){e.modals=t},expression:"modals"}},[n("div",{staticClass:"captchaBox"},[n("div",{ref:"captcha",staticStyle:{position:"relative"},attrs:{id:"captcha"}}),n("div",{attrs:{id:"msg"}})])])],1)},a=[],o=n("a34a"),r=n.n(o),s=n("5723"),c=n("8af8"),l=n("2f62");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f={components:{iHeaderI18n:c["a"]},computed:d({},Object(l["e"])("admin/layout",["showI18n"]))},h=n("d708"),p=n("c276");n("7daa"),n("9973");function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}var y=310,b=155,x=42,k=9,C=Math.PI,I=x+2*k+3;function _(e,t){return Math.round(Math.random()*(t-e)+e)}function E(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function O(e){var t=new Image;return t.crossOrigin="Anonymous",t.onload=e,t.onerror=function(){t.setSrc(L())},t.setSrc=function(e){var n=window.navigator.userAgent.indexOf("Trident")>-1;if(n){var i=new XMLHttpRequest;i.onloadend=function(e){var n=new FileReader;n.readAsDataURL(e.target.response),n.onloadend=function(e){t.src=e.target.result}},i.open("GET",e),i.responseType="blob",i.send()}else t.src=e},t.setSrc(L()),t}function T(e,t){var n=document.createElement(e);return n.className=t,n}function j(e,t){e.classList.add(t)}function F(e,t){e.classList.remove(t)}function L(){return"https://picsum.photos/".concat(y,"/").concat(b,"/?image=").concat(_(0,1084))}function M(e,t,n,i){e.beginPath(),e.moveTo(t,n),e.arc(t+x/2,n-k+2,k,.72*C,2.26*C),e.lineTo(t+x,n),e.arc(t+x+k-2,n+x/2,k,1.21*C,2.78*C),e.lineTo(t+x,n+x),e.lineTo(t,n+x),e.arc(t+k-2,n+x/2,k+.4,2.76*C,1.24*C,!0),e.lineTo(t,n),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[i](),e.globalCompositeOperation="destination-over"}function S(e,t){return e+t}function R(e){return e*e}var N=function(){function e(t){var n=t.el,i=t.width,a=void 0===i?310:i,o=t.height,r=void 0===o?155:o,s=t.onSuccess,c=t.onFail,l=t.onRefresh;g(this,e),y=a,b=r,console.log(n),n.style.position="relative",n.style.width=y+"px",Object.assign(n.style,{position:"relative",width:y+"px",margin:"0 auto"}),this.el=n,this.onSuccess=s,this.onFail=c,this.onRefresh=l}return w(e,[{key:"init",value:function(){this.initDOM(),this.initImg(),this.bindEvents()}},{key:"initDOM",value:function(){var e=E(y,b),t=e.cloneNode(!0),n=T("div","sliderContainer");n.style.width=y+"px";var i=T("div","refreshIcon"),a=T("div","sliderMask"),o=T("div","slider"),r=T("span","sliderIcon"),s=T("span","sliderText");t.className="block",s.innerHTML="向右滑动填充拼图";var c=this.el;c.appendChild(e),c.appendChild(i),c.appendChild(t),o.appendChild(r),a.appendChild(o),n.appendChild(a),n.appendChild(s),c.appendChild(n),Object.assign(this,{canvas:e,block:t,sliderContainer:n,refreshIcon:i,slider:o,sliderMask:a,sliderIcon:r,text:s,canvasCtx:e.getContext("2d"),blockCtx:t.getContext("2d")})}},{key:"initImg",value:function(){var e=this,t=O((function(){e.draw(),e.canvasCtx.drawImage(t,0,0,y,b),e.blockCtx.drawImage(t,0,0,y,b);var n=e.y-2*k-1,i=e.blockCtx.getImageData(e.x-3,n,I,I);e.block.width=I,e.blockCtx.putImageData(i,0,n)}));this.img=t}},{key:"draw",value:function(){this.x=_(I+10,y-(I+10)),this.y=_(10+2*k,b-(I+10)),M(this.canvasCtx,this.x,this.y,"fill"),M(this.blockCtx,this.x,this.y,"clip")}},{key:"clean",value:function(){this.canvasCtx.clearRect(0,0,y,b),this.blockCtx.clearRect(0,0,y,b),this.block.width=y}},{key:"bindEvents",value:function(){var e=this;this.el.onselectstart=function(){return!1},this.refreshIcon.onclick=function(){e.reset(),"function"===typeof e.onRefresh&&e.onRefresh()};var t,n,i=[],a=!1,o=function(e){t=e.clientX||e.touches[0].clientX,n=e.clientY||e.touches[0].clientY,a=!0},r=function(o){if(!a)return!1;var r=o.clientX||o.touches[0].clientX,s=o.clientY||o.touches[0].clientY,c=r-t,l=s-n;if(c<0||c+38>=y)return!1;e.slider.style.left=c+"px";var u=(y-40-20)/(y-40)*c;e.block.style.left=u+"px",j(e.sliderContainer,"sliderContainer_active"),e.sliderMask.style.width=c+"px",i.push(l)},s=function(n){if(!a)return!1;a=!1;var o=n.clientX||n.changedTouches[0].clientX;if(o===t)return!1;F(e.sliderContainer,"sliderContainer_active"),e.trail=i;var r=e.verify(),s=r.spliced,c=r.verified;s?c?(j(e.sliderContainer,"sliderContainer_success"),"function"===typeof e.onSuccess&&e.onSuccess()):(j(e.sliderContainer,"sliderContainer_fail"),e.text.innerHTML="请再试一次",e.reset()):(j(e.sliderContainer,"sliderContainer_fail"),"function"===typeof e.onFail&&e.onFail(),setTimeout((function(){e.reset()}),1e3))};this.slider.addEventListener("mousedown",o),this.slider.addEventListener("touchstart",o),this.block.addEventListener("mousedown",o),this.block.addEventListener("touchstart",o),document.addEventListener("mousemove",r),document.addEventListener("touchmove",r),document.addEventListener("mouseup",s),document.addEventListener("touchend",s)}},{key:"verify",value:function(){var e=this.trail,t=e.reduce(S)/e.length,n=e.map((function(e){return e-t})),i=Math.sqrt(n.map(R).reduce(S)/e.length),a=parseInt(this.block.style.left);return{spliced:Math.abs(a-this.x)<10,verified:0!==i}}},{key:"reset",value:function(){this.sliderContainer.className="sliderContainer",this.slider.style.left=0,this.block.style.left=0,this.sliderMask.style.width=0,this.clean(),this.img.setSrc(L())}}]),e}();function $(e,t,n,i,a,o,r){try{var s=e[o](r),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(i,a)}function P(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function r(e){$(o,i,a,r,s,"next",e)}function s(e){$(o,i,a,r,s,"throw",e)}r(void 0)}))}}window.jigsaw={init:function(e){var t=new N(e);return t.init(),t}};var z={mixins:[f],data:function(){return{fullWidth:document.documentElement.clientWidth,swiperOption:{pagination:".swiper-pagination",autoplay:!0},modals:!1,autoLogin:!0,imgcode:"",formInline:{username:"",password:"",code:""},ruleInline:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},errorNum:0,jigsaw:null,login_logo:"",swiperList:[],defaultSwiperList:n("433f")}},created:function(){var e=this;top!=window&&(top.location.href=location.href),document.onkeydown=function(t){if("login"===e.$route.name){var n=window.event.keyCode;13===n&&e.handleSubmit("formInline")}},window.addEventListener("resize",this.handleResize)},watch:{fullWidth:function(e){if(!this.timer){this.screenWidth=e,this.timer=!0;var t=this;setTimeout((function(){t.timer=!1}),400)}},$route:function(e){console.log(e),this.captchas()}},mounted:function(){var e=this;this.$nextTick((function(){var t=e;e.jigsaw=jigsaw.init({el:e.$refs.captcha,onSuccess:function(){t.modals=!1,t.closeModel()},onFail:e.closefail,onRefresh:function(){}}),e.screenWidth<768?document.getElementsByTagName("canvas")[0].removeAttribute("class","index_bg"):document.getElementsByTagName("canvas")[0].className="index_bg",e.swiperData()})),this.captchas()},methods:{swiperData:function(){var e=this;Object(s["d"])().then((function(t){var i=t.data||{};e.login_logo=i.login_logo?i.login_logo:n("9d64"),e.swiperList=i.slide.length?i.slide:[{slide:e.defaultSwiperList}]})).catch((function(t){e.$Message.error(t.msg)}))},closeModel:function(){var e=this,t=this.$Message.loading({content:"登录中...",duration:0});Object(s["a"])({account:this.formInline.username,pwd:this.formInline.password,imgcode:this.formInline.code}).then(function(){var n=P(r.a.mark((function n(i){var a,o;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t(),a=e.getExpiresTime(i.data.expires_time),p["a"].cookies.set("uuid",i.data.user_info.id,{expires:a}),p["a"].cookies.set("token",i.data.token,{expires:a}),p["a"].cookies.set("expires_time",i.data.expires_time,{expires:a}),n.next=7,e.$store.dispatch("admin/db/database",{user:!0});case 7:return o=n.sent,o.set("menus",i.data.menus).set("unique_auth",i.data.unique_auth).set("user_info",i.data.user_info).write(),e.$store.dispatch("admin/user/set",{name:i.data.user_info.account,avatar:i.data.user_info.head_pic,access:i.data.unique_auth,logo:i.data.logo,logoSmall:i.data.logo_square,version:i.data.version,newOrderAudioLink:i.data.newOrderAudioLink}),e.jigsaw&&e.jigsaw.reset(),n.abrupt("return",e.$router.replace({path:e.$route.query.redirect||"/admin/"}));case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(n){t();var i=void 0===n?{}:n;e.errorNum++,e.captchas(),e.$Message.error(i.msg||"登录失败"),e.jigsaw&&e.jigsaw.reset()}))},getExpiresTime:function(e){var t=Math.round(new Date/1e3),n=e-t;return parseFloat(parseFloat(parseFloat(n/60)/60)/24)},closefail:function(){this.jigsaw&&this.jigsaw.reset(),this.$Message.error("校验错误")},handleResize:function(e){this.fullWidth=document.documentElement.clientWidth,this.fullWidth<768?document.getElementsByTagName("canvas")[0].removeAttribute("class","index_bg"):document.getElementsByTagName("canvas")[0].className="index_bg"},captchas:function(){this.imgcode=h["a"].apiBaseURL+"/captcha_pro?"+Date.parse(new Date)},handleSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.errorNum>=2?t.modals=!0:t.closeModel())}))}},beforeCreate:function(){this.fullWidth<768?document.getElementsByTagName("canvas")[0].removeAttribute("class","index_bg"):document.getElementsByTagName("canvas")[0].className="index_bg"},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize),document.getElementsByTagName("canvas")[0].removeAttribute("class","index_bg")}},W=z,q=(n("49ee"),n("2877")),A=Object(q["a"])(W,i,a,!1,null,"dea97abe",null);t["default"]=A.exports},"433f":function(e,t,n){e.exports=n.p+"view_admin/img/sw.e426d944.jpg"},"49ee":function(e,t,n){"use strict";var i=n("d30a"),a=n.n(i);a.a},"7daa":function(e,t){!function(){function e(e,t,n){return e.getAttribute(t)||n}function t(e){return document.getElementsByTagName(e)}function n(){var n=t("script"),i=n.length,a=n[i-1];return{l:i,z:e(a,"zIndex",-2),o:e(a,"opacity",.8),c:e(a,"color","255,255,255"),n:e(a,"count",240)}}function i(){o=s.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=s.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function a(){if(d+=1,d<5)m(a);else{d=0,u.clearRect(0,0,o,r);var e,t,n,i,s,l,f=[h].concat(p);p.forEach((function(a){for(a.x+=a.xa,a.y+=a.ya,a.xa*=a.x>o||a.x<0?-1:1,a.ya*=a.y>r||a.y<0?-1:1,u.fillRect(a.x-.5,a.y-.5,2,2),u.fillStyle="#FFFFFF",t=0;t<f.length;t++)e=f[t],a!==e&&null!==e.x&&null!==e.y&&(i=a.x-e.x,s=a.y-e.y,l=i*i+s*s,l<e.max&&(e===h&&l>=e.max/2&&(a.x-=.03*i,a.y-=.03*s),n=(e.max-l)/e.max,u.beginPath(),u.lineWidth=n/2,u.strokeStyle="rgba("+c.c+","+(n+.2)+")",u.moveTo(a.x,a.y),u.lineTo(e.x,e.y),u.stroke()));f.splice(f.indexOf(a),1)})),m(a)}}var o,r,s=document.createElement("canvas"),c=n(),l="c_n"+c.l,u=s.getContext("2d"),d=0,m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/45)},f=Math.random,h={x:null,y:null,max:2e4};s.id=l,s.style.cssText="position:fixed;top:0;left:0;z-index:"+c.z+";opacity:"+c.o,t("body")[0].appendChild(s),i(),window.onresize=i,window.onmousemove=function(e){e=e||window.event,h.x=e.clientX,h.y=e.clientY},window.onmouseout=function(){h.x=null,h.y=null};for(var p=[],g=0;c.n>g;g++){var v=f()*o,w=f()*r,y=2*f()-1,b=2*f()-1;p.push({x:v,y:w,xa:y,ya:b,max:6e3})}setTimeout((function(){a()}),100)}()},9973:function(e,t,n){},d30a:function(e,t,n){}}]);