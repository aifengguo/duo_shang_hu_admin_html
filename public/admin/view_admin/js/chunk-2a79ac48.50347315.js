(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a79ac48"],{"08ea":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"i-layout-page-header"},[a("PageHeader",{staticClass:"product_tabs",attrs:{title:"会员管理"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("Tabs",{on:{"on-click":t.onClickTab}},t._l(t.headeNum,(function(t,e){return a("TabPane",{key:e,attrs:{label:t.name,name:t.type}})})),1)],1)])],1),a("Card",{staticClass:"ivu-mt listbox",attrs:{bordered:!1,"dis-hover":""}},[a("Form",{ref:"userFrom",attrs:{model:t.userFrom,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[a("Row",{attrs:{gutter:16}},[a("Col",{attrs:{span:"18"}},[a("Col",{attrs:{span:"24"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"会员搜索：","label-for":"nickname"}},[a("Input",{attrs:{placeholder:"请输入","element-id":"nickname",clearable:""},model:{value:t.userFrom.nickname,callback:function(e){t.$set(t.userFrom,"nickname",e)},expression:"userFrom.nickname"}})],1)],1)],1)],1),t.collapse?[a("Col",{attrs:{span:"18"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"会员等级：","label-for":"level"}},[a("Select",{attrs:{placeholder:"请选择","element-id":"level",clearable:""},model:{value:t.userFrom.level,callback:function(e){t.$set(t.userFrom,"level",e)},expression:"userFrom.level"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),t._l(t.levelList,(function(e,r){return a("Option",{key:r,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],2)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"会员分组：","label-for":"group_id"}},[a("Select",{attrs:{placeholder:"请选择","element-id":"group_id",clearable:""},model:{value:t.userFrom.group_id,callback:function(e){t.$set(t.userFrom,"group_id",e)},expression:"userFrom.group_id"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),t._l(t.groupList,(function(e,r){return a("Option",{key:r,attrs:{value:e.id}},[t._v(t._s(e.group_name))])}))],2)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"会员标签：","label-for":"label_id"}},[a("Select",{attrs:{placeholder:"请选择","element-id":"label_id",clearable:""},model:{value:t.userFrom.label_id,callback:function(e){t.$set(t.userFrom,"label_id",e)},expression:"userFrom.label_id"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),t._l(t.labelLists,(function(e,r){return a("Option",{key:r,attrs:{value:e.id}},[t._v(t._s(e.label_name))])}))],2)],1)],1)],1),a("Col",{attrs:{span:"18"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"国家：","label-for":"country"}},[a("Select",{attrs:{placeholder:"请选择","element-id":"country",clearable:""},on:{"on-change":t.changeCountry},model:{value:t.userFrom.country,callback:function(e){t.$set(t.userFrom,"country",e)},expression:"userFrom.country"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),a("Option",{attrs:{value:"domestic"}},[t._v("中国")]),a("Option",{attrs:{value:"abroad"}},[t._v("外国")])],1)],1)],1),"domestic"===t.userFrom.country?a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"省份："}},[a("Cascader",{attrs:{data:t.addresData,value:t.address},on:{"on-change":t.handleChange},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1)],1):t._e()],1),a("Col",{attrs:{span:"18"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"性别：","label-for":"sex"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:t.userFrom.sex,callback:function(e){t.$set(t.userFrom,"sex",e)},expression:"userFrom.sex"}},[a("Radio",{attrs:{label:""}},[a("span",[t._v("全部")])]),a("Radio",{attrs:{label:"1"}},[a("span",[t._v("男")])]),a("Radio",{attrs:{label:"2"}},[a("span",[t._v("女")])]),a("Radio",{attrs:{label:"0"}},[a("span",[t._v("保密")])])],1)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"身份：","label-for":"is_promoter"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:t.userFrom.is_promoter,callback:function(e){t.$set(t.userFrom,"is_promoter",e)},expression:"userFrom.is_promoter"}},[a("Radio",{attrs:{label:""}},[a("span",[t._v("全部")])]),a("Radio",{attrs:{label:"1"}},[a("span",[t._v("推广员")])]),a("Radio",{attrs:{label:"0"}},[a("span",[t._v("普通会员")])])],1)],1)],1)],1),a("Col",{attrs:{span:"18"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"访问情况：","label-for":"user_time_type"}},[a("Select",{attrs:{placeholder:"请选择","element-id":"user_time_type",clearable:""},model:{value:t.userFrom.user_time_type,callback:function(e){t.$set(t.userFrom,"user_time_type",e)},expression:"userFrom.user_time_type"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),a("Option",{attrs:{value:"visitno"}},[t._v("时间段未访问")]),a("Option",{attrs:{value:"visit"}},[t._v("时间段访问过")]),a("Option",{attrs:{value:"add_time"}},[t._v("首次访问")])],1)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"消费情况：","label-for":"pay_count"}},[a("Select",{attrs:{placeholder:"请选择","element-id":"pay_count",clearable:""},model:{value:t.userFrom.pay_count,callback:function(e){t.$set(t.userFrom,"pay_count",e)},expression:"userFrom.pay_count"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),a("Option",{attrs:{value:"-1"}},[t._v("0")]),a("Option",{attrs:{value:"0"}},[t._v("1+")]),a("Option",{attrs:{value:"1"}},[t._v("2+")]),a("Option",{attrs:{value:"2"}},[t._v("3+")]),a("Option",{attrs:{value:"3"}},[t._v("4+")]),a("Option",{attrs:{value:"4"}},[t._v("5+")])],1)],1)],1)],1),a("Col",{attrs:{span:"18"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"选择时间：","label-for":"user_time"}},[a("DatePicker",{staticClass:"mr20",staticStyle:{width:"300px"},attrs:{value:t.timeVal,format:"yyyy/MM/dd",type:"datetimerange",placement:"bottom-start",placeholder:"自定义时间",options:t.options},on:{"on-change":t.onchangeTime}})],1)],1)],1)]:t._e(),a("Col",{staticClass:"ivu-text-right userFrom",attrs:{span:"6"}},[a("FormItem",[a("Button",{staticClass:"mr15",attrs:{type:"primary",icon:"ios-search",label:"default"},on:{click:t.userSearchs}},[t._v("搜索")]),a("Button",{staticClass:"ResetSearch",on:{click:function(e){return t.reset("userFrom")}}},[t._v("重置")]),a("a",{directives:[{name:"font",rawName:"v-font",value:14,expression:"14"}],staticClass:"ivu-ml-8",on:{click:function(e){t.collapse=!t.collapse}}},[t.collapse?[t._v("\n                                    收起 "),a("Icon",{attrs:{type:"ios-arrow-up"}})]:[t._v("\n                                    展开 "),a("Icon",{attrs:{type:"ios-arrow-down"}})]],2)],1)],1)],2)],1),a("Divider",{attrs:{dashed:""}}),a("Row",{staticClass:"mt20",attrs:{type:"flex",justify:"space-between"}},[a("Col",{attrs:{span:"24"}},[a("Button",{directives:[{name:"auth",rawName:"v-auth",value:["admin-user-coupon"],expression:"['admin-user-coupon']"}],staticClass:"mr20",attrs:{type:"primary"},on:{click:t.onSend}},[t._v("发送优惠券")]),"wechat"===t.userFrom.user_type?a("Button",{directives:[{name:"auth",rawName:"v-auth",value:["admin-wechat-news"],expression:"['admin-wechat-news']"}],staticClass:"greens mr20",attrs:{size:"default"},on:{click:t.onSendPic}},[a("Icon",{attrs:{type:"md-list"}}),t._v("\n                        发送图文消息\n                    ")],1):t._e(),a("Button",{directives:[{name:"auth",rawName:"v-auth",value:["admin-user-group_set"],expression:"['admin-user-group_set']"}],staticClass:"mr20",on:{click:t.setGroup}},[t._v("批量设置分组")]),a("Button",{directives:[{name:"auth",rawName:"v-auth",value:["admin-user-set_label"],expression:"['admin-user-set_label']"}],staticClass:"mr20",on:{click:t.setLabel}},[t._v("批量设置标签")])],1),t.selectionList.length?a("Col",{staticClass:"userAlert",attrs:{span:"24"}},[a("Alert",{attrs:{"show-icon":""}},[t._v(" 已选择"),a("i",{staticClass:"userI"},[t._v(" "+t._s(t.selectionList.length)+" ")]),t._v("项")])],1):t._e()],1),a("Table",{ref:"table",staticClass:"mt25",attrs:{columns:t.columns,data:t.userLists,"highlight-row":"",loading:t.loading,"no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"},on:{"on-selection-change":t.onSelectTab},scopedSlots:t._u([{key:"avatars",fn:function(t){var e=t.row;t.index;return[a("viewer",[a("div",{staticClass:"tabBox_img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatar,expression:"row.avatar"}]})])])]}},{key:"nickname",fn:function(e){var r=e.row;e.index;return[a("div",{staticClass:"acea-row"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:"男"===r.sex,expression:"row.sex==='男'"}],staticClass:"mr5",attrs:{type:"md-male",color:"#2db7f5",size:"15"}}),a("Icon",{directives:[{name:"show",rawName:"v-show",value:"女"===r.sex,expression:"row.sex==='女'"}],staticClass:"mr5",attrs:{type:"md-female",color:"#ed4014",size:"15"}}),a("div",{domProps:{textContent:t._s(r.nickname)}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:r.vip_name,expression:"row.vip_name"}],staticClass:"vipName"},[t._v(t._s(r.vip_name))])]}},{key:"action",fn:function(e){var r=e.row,n=e.index;return[a("a",{on:{click:function(e){return t.edit(r)}}},[t._v("编辑")]),a("Divider",{attrs:{type:"vertical"}}),[a("Dropdown",{on:{"on-click":function(e){return t.changeMenu(r,e,n)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[t._v("\n                                更多\n                                "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"1"}},[t._v("账户详情")]),a("DropdownItem",{attrs:{name:"2"}},[t._v("积分余额")]),a("DropdownItem",{attrs:{name:"3"}},[t._v("赠送会员")]),r.vip_name?a("DropdownItem",{attrs:{name:"4"}},[t._v("清除等级")]):t._e(),a("DropdownItem",{attrs:{name:"5"}},[t._v("设置分组")]),a("DropdownItem",{attrs:{name:"6"}},[t._v("设置标签")])],1)],1)]]}}])}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:t.total,current:t.userFrom.page,"show-elevator":"","show-total":"","page-size":t.userFrom.limit},on:{"on-change":t.pageChange}})],1)],1),a("edit-from",{ref:"edits",attrs:{FromData:t.FromData},on:{submitFail:t.submitFail}}),a("send-from",{ref:"sends",attrs:{userIds:t.user_ids}}),a("user-details",{ref:"userDetails"}),a("Modal",{staticClass:"modelBox",attrs:{scrollable:"",title:"发送消息",width:"1200",height:"800","footer-hide":""},model:{value:t.modal13,callback:function(e){t.modal13=e},expression:"modal13"}},[t.modal13?a("news-category",{attrs:{isShowSend:t.isShowSend,userIds:t.user_ids,scrollerHeight:t.scrollerHeight,contentTop:t.contentTop,contentWidth:t.contentWidth,maxCols:t.maxCols}}):t._e()],1)],1)},n=[],s=a("a34a"),i=a.n(s),o=a("2f62"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticClass:"expand-row"},[a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("首次访问：")]),a("span",{staticClass:"expand-value"},[t._v(" "+t._s(t._f("formatDate")(t.row.add_time)))])]),a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("近次访问：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t._f("formatDate")(t.row.last_time)))])]),a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("身份证号：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.card_id))])]),a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("手机号：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.phone))])])],1),a("Row",{staticClass:"expand-row"},[a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("真实姓名：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.real_name))])]),a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("标签：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.labels))])]),a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("生日：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.birthday))])]),a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("地址：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.addres))])])],1),a("Row",{staticClass:"expand-row"},[a("Col",{attrs:{span:"6"}},[a("span",{staticClass:"expand-key"},[t._v("备注：")]),a("span",{staticClass:"expand-value"},[t._v(t._s(t.row.mark))])])],1)],1)},u=[],c=a("61f7"),d={name:"table-expand",filters:{formatDate:function(t){if(0!==t){var e=new Date(1e3*t);return Object(c["a"])(e,"yyyy-MM-dd hh:mm")}}},props:{row:Object}},m=d,p=(a("7e7c"),a("2877")),h=Object(p["a"])(m,l,u,!1,null,"0a6fe7fd",null),f=h.exports,v=a("c24f"),g=a("31b4"),b=a("a8e0"),_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"100%"}},[a("Modal",{attrs:{scrollable:"","footer-hide":"",closable:"",title:"会员详情","mask-closable":!1,width:"900"},model:{value:t.modals,callback:function(e){t.modals=e},expression:"modals"}},[t.spinShow?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("div",{staticClass:"acea-row"},[a("div",{staticClass:"avatar mr15"},[a("img",{attrs:{src:t.psInfo.avatar}})]),a("div",{staticClass:"dashboard-workplace-header-tip"},[a("p",{staticClass:"dashboard-workplace-header-tip-title",domProps:{textContent:t._s(t.psInfo.nickname||"-")}}),a("div",{staticClass:"dashboard-workplace-header-tip-desc"},t._l(t.detailsData,(function(e,r){return a("span",{key:r,staticClass:"dashboard-workplace-header-tip-desc-sp"},[t._v(t._s(e.title+"："+e.value))])})),0)])]),a("Row",{staticClass:"mt25",attrs:{type:"flex",justify:"space-between"}},[a("Col",{staticClass:"user_menu",attrs:{span:"4"}},[a("Menu",{attrs:{theme:t.theme2,"active-name":"order"},on:{"on-select":t.changeType}},t._l(t.list,(function(e,r){return a("MenuItem",{key:r,attrs:{name:e.val}},[t._v("\n                        "+t._s(e.label)+"\n                    ")])})),1)],1),a("Col",{attrs:{span:"20"}},[a("Table",{ref:"table",attrs:{columns:t.columns,data:t.userLists,"max-height":"400",loading:t.loading,"no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"}}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:t.total,"show-elevator":"","show-total":"","page-size":t.userFrom.limit},on:{"on-change":t.changeType}})],1)],1)],1)],1)],1)},w=[];function y(t,e,a,r,n,s,i){try{var o=t[s](i),l=o.value}catch(u){return void a(u)}o.done?e(l):Promise.resolve(l).then(r,n)}function k(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var s=t.apply(e,a);function i(t){y(s,r,n,i,o,"next",t)}function o(t){y(s,r,n,i,o,"throw",t)}i(void 0)}))}}var F={name:"userDetails",data:function(){return{theme2:"light",list:[{val:"order",label:"消费记录"},{val:"integral",label:"积分明细"},{val:"sign",label:"签到记录"},{val:"coupon",label:"持有优惠券"},{val:"balance_change",label:"余额变动"},{val:"spread",label:"好友关系"}],modals:!1,spinShow:!1,detailsData:[],userId:0,loading:!1,userFrom:{type:"order",page:1,limit:20},total:0,columns:[],userLists:[],psInfo:{}}},created:function(){},methods:{getDetails:function(t){var e=this;this.userId=t,this.spinShow=!0,Object(v["d"])(t).then(function(){var t=k(i.a.mark((function t(a){var r;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:200===a.status?(r=a.data,e.detailsData=r.headerList,e.psInfo=r.ps_info,e.changeType(name),e.spinShow=!1):(e.spinShow=!1,e.$Message.error(a.msg));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.spinShow=!1,e.$Message.error(t.msg)}))},changeType:function(t){var e=this;this.loading=!0,this.userFrom.type=t,""===this.userFrom.type&&(this.userFrom.type="order");var a={id:this.userId,datas:this.userFrom};Object(v["i"])(a).then(function(){var t=k(i.a.mark((function t(a){var r;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(200!==a.status){t.next=21;break}r=a.data,e.userLists=r.list,e.total=r.count,t.t0=e.userFrom.type,t.next="order"===t.t0?7:"integral"===t.t0?9:"sign"===t.t0?11:"coupon"===t.t0?13:"balance_change"===t.t0?15:17;break;case 7:return e.columns=[{title:"订单ID",key:"order_id",minWidth:160},{title:"收货人",key:"real_name",minWidth:100},{title:"商品数量",key:"total_num",minWidth:90},{title:"商品总价",key:"total_price",minWidth:110},{title:"实付金额",key:"pay_price",minWidth:120},{title:"交易完成时间",key:"pay_time",minWidth:120}],t.abrupt("break",18);case 9:return e.columns=[{title:"来源/用途",key:"title",minWidth:120},{title:"积分变化",key:"number",minWidth:120},{title:"变化后积分",key:"balance",minWidth:120},{title:"日期",key:"add_time",minWidth:120},{title:"备注",key:"mark",minWidth:120}],t.abrupt("break",18);case 11:return e.columns=[{title:"动作",key:"title",minWidth:120},{title:"获得积分",key:"number",minWidth:120},{title:"签到时间",key:"add_time",minWidth:120},{title:"备注",key:"mark",minWidth:120}],t.abrupt("break",18);case 13:return e.columns=[{title:"优惠券名称",key:"coupon_title",minWidth:120},{title:"面值",key:"coupon_price",minWidth:120},{title:"有效期",key:"_add_time",minWidth:120},{title:"所需积分",key:"integral",minWidth:120},{title:"兑换时间",key:"_add_time",minWidth:120}],t.abrupt("break",18);case 15:return e.columns=[{title:"变动金额",key:"number",minWidth:120},{title:"变动后",key:"balance",minWidth:120},{title:"类型",key:"type",minWidth:120},{title:"创建时间",key:"add_time",minWidth:120},{title:"备注",key:"mark",minWidth:120}],t.abrupt("break",18);case 17:e.columns=[{title:"ID",key:"uid",minWidth:120},{title:"昵称",key:"nickname",minWidth:120},{title:"等级",key:"type",minWidth:120},{title:"加入时间",key:"add_time",minWidth:120}];case 18:e.loading=!1,t.next=23;break;case 21:e.loading=!1,e.$Message.error(a.msg);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.loading=!1,e.$Message.error(t.msg)}))}}},x=F,C=(a("7b73"),a("b399"),Object(p["a"])(x,_,w,!1,null,"aba3e30e",null)),O=C.exports,D=a("c42b"),j=a("2e8e");function $(t,e,a,r,n,s,i){try{var o=t[s](i),l=o.value}catch(u){return void a(u)}o.done?e(l):Promise.resolve(l).then(r,n)}function L(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var s=t.apply(e,a);function i(t){$(s,r,n,i,o,"next",t)}function o(t){$(s,r,n,i,o,"throw",t)}i(void 0)}))}}function M(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function S(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?M(a,!0).forEach((function(e){I(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):M(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function I(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var W={name:"user_list",components:{expandRow:f,editFrom:g["a"],sendFrom:b["a"],userDetails:O,newsCategory:D["a"]},data:function(){return{options:{shortcuts:[{text:"今天",value:function(){var t=new Date,e=new Date;return e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),[e,t]}},{text:"昨天",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1))),t.setTime(t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()))),[e,t]}},{text:"最近7天",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-6))),[e,t]}},{text:"最近30天",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-29))),[e,t]}},{text:"本月",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),1))),[e,t]}},{text:"本年",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),0,1))),[e,t]}}]},collapse:!1,headeNum:[{type:"",name:"全部会员"},{type:"wechat",name:"微信公众号"},{type:"routine",name:"微信小程序"},{type:"h5",name:"H5"}],address:[],addresData:j["a"],isShowSend:!0,modal13:!1,maxCols:4,scrollerHeight:"600",contentTop:"130",contentWidth:"98%",grid:{xl:8,lg:8,md:12,sm:24,xs:24},grid2:{xl:18,lg:16,md:12,sm:24,xs:24},loading:!1,total:0,userFrom:{label_id:"",user_type:"",status:"",sex:"",is_promoter:"",country:"",pay_count:"",user_time_type:"",user_time:"",nickname:"",province:"",city:"",page:1,limit:15,level:"",group_id:""},columns:[{type:"expand",width:40,render:function(t,e){return t(f,{props:{row:e.row}})}},{type:"selection",width:60,align:"center"},{title:"ID",key:"uid",width:80},{title:"头像",slot:"avatars",minWidth:60},{title:"姓名",slot:"nickname",minWidth:150},{title:"会员等级",key:"level",minWidth:100},{title:"分组",key:"group_id",minWidth:100},{title:"推荐人",key:"spread_uid_nickname",minWidth:100},{title:"用户类型",key:"user_type",minWidth:100},{title:"余额",key:"now_money",sortable:!0,minWidth:100},{title:"操作",slot:"action",fixed:"right",minWidth:120}],userLists:[],FromData:null,selectionList:[],user_ids:"",selectedData:[],timeVal:[],array_ids:[],groupList:[],levelList:[],labelFrom:{page:1,limit:""},labelLists:[]}},computed:S({},Object(o["e"])("admin/layout",["isMobile"]),{labelWidth:function(){return this.isMobile?void 0:100},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getList()},mounted:function(){this.userGroup(),this.levelLists(),this.groupLists()},methods:{groupLists:function(){var t=this;this.loading=!0,Object(v["s"])(this.labelFrom).then(function(){var e=L(i.a.mark((function e(a){var r;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=a.data,t.labelLists=r.list;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},onClickTab:function(t){this.userFrom.page=1,this.userFrom.user_type=t,this.getList()},userGroup:function(){var t=this,e={page:1,limit:""};Object(v["q"])(e).then((function(e){t.groupList=e.data.list}))},levelLists:function(){var t=this,e={page:1,limit:"",title:"",is_show:1};Object(v["k"])(e).then((function(e){t.levelList=e.data.list}))},setGroup:function(){var t=this;if(0===this.selectionList.length)this.$Message.warning("请选择要设置分组的会员");else{var e={uids:this.array_ids};this.$modalForm(Object(v["u"])(e)).then((function(){return t.$refs.sends.getList()}))}},setLabel:function(){var t=this;if(0===this.selectionList.length)this.$Message.warning("请选择要设置标签的会员");else{var e={uids:this.array_ids};this.$modalForm(Object(v["v"])(e)).then((function(){return t.$refs.sends.getList()}))}},changeCountry:function(){"abroad"!==this.userFrom.country&&this.userFrom.country||(this.selectedData=[],this.userFrom.province="",this.userFrom.city="",this.address=[])},handleChange:function(t,e){this.selectedData=e.map((function(t){return t.label})),this.userFrom.province=this.selectedData[0],this.userFrom.city=this.selectedData[1]},onchangeTime:function(t){this.timeVal=t,this.userFrom.user_time=this.timeVal.join("-")},changeMenu:function(t,e,a){var r=this,n=[];n.push(t.uid);var s={uids:n};switch(e){case"1":this.$refs.userDetails.modals=!0,this.$refs.userDetails.getDetails(t.uid);break;case"2":this.getOtherFrom(t.uid);break;case"3":this.giveLevel(t.uid);break;case"5":this.$modalForm(Object(v["u"])(s)).then((function(){return r.$refs.sends.getList()}));break;case"6":this.$modalForm(Object(v["v"])(s)).then((function(){return r.$refs.sends.getList()}));break;default:this.del(t,"清除 【 "+t.nickname+" 】的会员等级",a)}},giveLevel:function(t){var e=this;Object(v["g"])(t).then(function(){var t=L(i.a.mark((function t(a){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!1!==a.data.status){t.next=2;break}return t.abrupt("return",e.$authLapse(a.data));case 2:e.FromData=a.data,e.$refs.edits.modals=!0;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},del:function(t,e,a){var r=this,n={title:e,num:a,url:"user/del_level/".concat(t.uid),method:"DELETE",ids:""};this.$modalSure(n).then((function(t){r.$Message.success(t.msg),r.getList()})).catch((function(t){r.$Message.error(t.msg)}))},submitModel:function(){this.getList()},getList:function(){var t=this;this.loading=!0,this.userFrom.user_type=this.userFrom.user_type||"",this.userFrom.status=this.userFrom.status||"",this.userFrom.sex=this.userFrom.sex||"",this.userFrom.is_promoter=this.userFrom.is_promoter||"",this.userFrom.country=this.userFrom.country||"",this.userFrom.user_time_type=this.userFrom.user_time_type||"",this.userFrom.pay_count=this.userFrom.pay_count||"",this.userFrom.label_id=this.userFrom.label_id||"",Object(v["t"])(this.userFrom).then(function(){var e=L(i.a.mark((function e(a){var r;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=a.data,t.userLists=r.list,t.total=r.count,t.loading=!1;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},pageChange:function(t){this.userFrom.page=t,this.getList()},userSearchs:function(){this.userFrom.page=1,this.getList()},reset:function(t){this.userFrom={user_type:"",status:"",sex:"",is_promoter:"",country:"",pay_count:"",user_time_type:"",user_time:"",nickname:"",page:1,limit:20},this.getList()},getUserFrom:function(t){var e=this;Object(v["f"])(t).then(function(){var t=L(i.a.mark((function t(a){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!1!==a.data.status){t.next=2;break}return t.abrupt("return",e.$authLapse(a.data));case 2:e.FromData=a.data,e.$refs.edits.modals=!0;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},getOtherFrom:function(t){var e=this;Object(v["e"])(t).then(function(){var t=L(i.a.mark((function t(a){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!1!==a.data.status){t.next=2;break}return t.abrupt("return",e.$authLapse(a.data));case 2:e.FromData=a.data,e.$refs.edits.modals=!0;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},onchangeIsShow:function(t){var e=this,a={id:t.uid,status:t.status};Object(v["j"])(a).then(function(){var t=L(i.a.mark((function t(a){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$Message.success(a.msg);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},onSelectTab:function(t){this.selectionList=t;var e=[];this.selectionList.map((function(t){e.push(t.uid)})),this.array_ids=e,this.user_ids=e.join(",")},onSend:function(){0===this.selectionList.length?this.$Message.warning("请选择要发送优惠券的会员"):(this.$refs.sends.modals=!0,this.$refs.sends.getList())},onSendPic:function(){0===this.selectionList.length?this.$Message.warning("请选择要发送图文消息的会员"):this.modal13=!0},edit:function(t){this.getUserFrom(t.uid)},submitFail:function(){this.getList()}}},P=W,T=(a("3d1c"),Object(p["a"])(P,r,n,!1,null,"e3fd54f8",null));e["default"]=T.exports},"0a8c":function(t,e,a){},"1e97":function(t,e,a){},"2d6e":function(t,e,a){},"31b4":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.FromData?a("div",[a("Modal",{attrs:{scrollable:"","footer-hide":"",closable:"",title:t.FromData.title,"z-index":1,width:"700"},on:{"on-cancel":t.cancel},model:{value:t.modals,callback:function(e){t.modals=e},expression:"modals"}},[["/marketing/coupon/save.html"===t.FromData.action?a("div",{staticClass:"radio acea-row row-middle"},[a("div",{staticClass:"name ivu-form-item-content"},[t._v("优惠券类型")]),a("Radio-group",{on:{"on-change":t.couponsType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("Radio",{attrs:{label:0}},[t._v("通用券")]),a("Radio",{attrs:{label:1}},[t._v("品类券")]),a("Radio",{attrs:{label:2}},[t._v("商品券")])],1)],1):t._e()],a("form-create",{ref:"fc",staticClass:"formBox",attrs:{option:t.config,rule:Array.from(t.FromData.rules),handleIcon:"false"},on:{"on-submit":t.onSubmit}})],2)],1):t._e()},n=[],s=a("9860"),i=a.n(s),o=a("b6bd"),l=a("2f62");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(a,!0).forEach((function(e){d(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var m={name:"edit",components:{formCreate:i.a.$form()},computed:c({},Object(l["e"])("admin/userLevel",["taskId","levelId"])),props:{FromData:{type:Object,default:null}},data:function(){return{modals:!1,type:0,config:{global:{upload:{props:{onSuccess:function(t,e){200===t.status?e.url=t.data.src:this.Message.error(t.msg)}}}}}}},methods:{couponsType:function(){this.$parent.addType(this.type)},onSubmit:function(t){var e=this,a={};a=t,Object(o["a"])({url:this.FromData.action,method:this.FromData.method,data:a}).then((function(t){e.$parent.getList(),e.$Message.success(t.msg),e.modals=!1,setTimeout((function(){e.$emit("submitFail")}),1e3)})).catch((function(t){e.$Message.error(t.msg)}))},cancel:function(){this.type=0}}},p=m,h=(a("c3a4"),a("2877")),f=Object(h["a"])(p,r,n,!1,null,"d7e9212a",null);e["a"]=f.exports},"3d1c":function(t,e,a){"use strict";var r=a("501b"),n=a.n(r);n.a},4964:function(t,e,a){},"501b":function(t,e,a){},"61f7":function(t,e,a){"use strict";function r(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var r in a)if(new RegExp("(".concat(r,")")).test(e)){var s=a[r]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?s:n(s))}return e}function n(t){return("00"+t).substr(t.length)}a.d(e,"a",(function(){return r}))},"7b73":function(t,e,a){"use strict";var r=a("b6e5"),n=a.n(r);n.a},"7e7c":function(t,e,a){"use strict";var r=a("0a8c"),n=a.n(r);n.a},a8e0:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{"z-index":100,scrollable:"","footer-hide":"",closable:"",title:"发送优惠券","mask-closable":!1,width:"900"},model:{value:t.modals,callback:function(e){t.modals=e},expression:"modals"}},[a("div",{staticClass:"acea-row"},[a("span",{staticClass:"sp"},[t._v("优惠券名称：")]),a("Input",{staticStyle:{width:"60%"},attrs:{search:"","enter-button":"",placeholder:"请输入优惠券名称"},on:{"on-search":t.userSearchs},model:{value:t.page.title,callback:function(e){t.$set(t.page,"title",e)},expression:"page.title"}})],1),a("Table",{ref:"table",staticClass:"mt25",attrs:{columns:t.columns,data:t.couponList,loading:t.loading,"highlight-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"},scopedSlots:t._u([{key:"action",fn:function(e){var r=e.row,n=e.index;return[a("a",{on:{click:function(e){return t.sendGrant(r,"发送优惠券",n)}}},[t._v("发送")])]}}])}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:t.total,"show-elevator":"","show-total":"","page-size":t.page.limit},on:{"on-change":t.pageChange}})],1)],1)],1)},n=[],s=a("a34a"),i=a.n(s),o=a("c24f");function l(t,e,a,r,n,s,i){try{var o=t[s](i),l=o.value}catch(u){return void a(u)}o.done?e(l):Promise.resolve(l).then(r,n)}function u(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var s=t.apply(e,a);function i(t){l(s,r,n,i,o,"next",t)}function o(t){l(s,r,n,i,o,"throw",t)}i(void 0)}))}}var c={name:"send",props:{userIds:{type:String,default:""}},data:function(){return{modals:!1,loading:!1,couponList:[],columns:[{title:"优惠券名称",key:"title",align:"center",minWidth:100},{title:"优惠卷面值",key:"coupon_price",align:"center",minWidth:80},{title:"优惠券最低消费",key:"use_min_price",align:"center",minWidth:150},{title:"优惠券有效期限",key:"coupon_time",align:"center",minWidth:120},{title:"操作",slot:"action",align:"center",width:120}],page:{page:1,limit:15,title:""},total:0}},methods:{getList:function(t){var e=this;this.loading=!0,Object(o["a"])(this.page).then(function(){var t=u(i.a.mark((function t(a){var r;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:200===a.status?(r=a.data,e.couponList=r.list,e.total=r.count,e.loading=!1):(e.loading=!1,e.$Message.error(a.msg));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.loading=!1,e.$Message.error(t.msg)}))},userSearchs:function(){this.getList()},pageChange:function(t){this.page.page=t,this.getList()},sendGrant:function(t,e,a){var r=this,n={title:e,num:a,url:"marketing/coupon/user/grant",method:"post",ids:{id:t.id,uid:this.userIds}};this.$modalSure(n).then((function(t){r.$Message.success(t.msg)})).catch((function(t){r.$Message.error(t.msg)}))}}},d=c,m=(a("b3c1"),a("2877")),p=Object(m["a"])(d,r,n,!1,null,"53b45d7c",null);e["a"]=p.exports},b399:function(t,e,a){"use strict";var r=a("4964"),n=a.n(r);n.a},b3c1:function(t,e,a){"use strict";var r=a("2d6e"),n=a.n(r);n.a},b6e5:function(t,e,a){},c24f:function(t,e,a){"use strict";a.d(e,"t",(function(){return n})),a.d(e,"f",(function(){return s})),a.d(e,"j",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return l})),a.d(e,"d",(function(){return u})),a.d(e,"i",(function(){return c})),a.d(e,"k",(function(){return d})),a.d(e,"l",(function(){return m})),a.d(e,"o",(function(){return p})),a.d(e,"n",(function(){return h})),a.d(e,"m",(function(){return f})),a.d(e,"c",(function(){return v})),a.d(e,"b",(function(){return g})),a.d(e,"g",(function(){return b})),a.d(e,"q",(function(){return _})),a.d(e,"h",(function(){return w})),a.d(e,"p",(function(){return y})),a.d(e,"u",(function(){return k})),a.d(e,"s",(function(){return F})),a.d(e,"r",(function(){return x})),a.d(e,"v",(function(){return C}));var r=a("b6bd");function n(t){return Object(r["a"])({url:"user/user",method:"get",params:t})}function s(t){return Object(r["a"])({url:"user/user/".concat(t,"/edit"),method:"get"})}function i(t){return Object(r["a"])({url:"user/set_status/".concat(t.status,"/").concat(t.id),method:"put"})}function o(t){return Object(r["a"])({url:"marketing/coupon/grant",method:"get",params:t})}function l(t){return Object(r["a"])({url:"user/edit_other/".concat(t),method:"get"})}function u(t){return Object(r["a"])({url:"user/user/".concat(t),method:"get"})}function c(t){return Object(r["a"])({url:"user/one_info/".concat(t.id),method:"get",params:t.datas})}function d(t){return Object(r["a"])({url:"user/user_level/vip_list",method:"get",params:t})}function m(t){return Object(r["a"])({url:"user/user_level/set_show/".concat(t.id,"/").concat(t.is_show),method:"PUT"})}function p(t,e){return Object(r["a"])({url:"user/user_level/task/".concat(t),method:"get",params:e})}function h(t){return Object(r["a"])({url:"user/user_level/set_task_show/".concat(t.id,"/").concat(t.is_show),method:"PUT"})}function f(t){return Object(r["a"])({url:"user/user_level/set_task_must/".concat(t.id,"/").concat(t.is_must),method:"PUT"})}function v(t){return Object(r["a"])({url:"/user/user_level/create_task",method:"get",params:t})}function g(t){return Object(r["a"])({url:"user/user_level/create",method:"get",params:t})}function b(t){return Object(r["a"])({url:"user/give_level/".concat(t),method:"get"})}function _(t){return Object(r["a"])({url:"user/user_group/list",method:"get",params:t})}function w(t){return Object(r["a"])({url:"user/user_group/add/".concat(t),method:"get"})}function y(t){return Object(r["a"])({url:"setting/update_admin",method:"PUT",data:t})}function k(t){return Object(r["a"])({url:"user/set_group",method:"post",data:t})}function F(t){return Object(r["a"])({url:"user/user_label",method:"get",data:t})}function x(t){return Object(r["a"])({url:"user/user_label/add/".concat(t),method:"get"})}function C(t){return Object(r["a"])({url:"user/set_label",method:"post",data:t})}},c3a4:function(t,e,a){"use strict";var r=a("1e97"),n=a.n(r);n.a}}]);