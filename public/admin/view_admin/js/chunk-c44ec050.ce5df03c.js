(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c44ec050"],{"248f":function(t,e,i){"use strict";var s=i("616f"),a=i.n(s);a.a},"29fb":function(t,e,i){"use strict";var s=i("b26a"),a=i.n(s);a.a},"616f":function(t,e,i){},"6bef":function(t,e){(function(){if(window.frameElement.id){var t=window.parent,e=t.$EDITORUI[window.frameElement.id.replace(/_iframe$/,"")],i=e.editor,s=t.UE,a=s.dom.domUtils,n=s.utils,r=(s.browser,s.ajax,function(t){return document.getElementById(t)});window.nowEditor={editor:i,dialog:e},n.loadFile(document,{href:i.options.themePath+i.options.theme+"/dialogbase.css?cache="+Math.random(),tag:"link",type:"text/css",rel:"stylesheet"});var o=i.getLang(e.className.split("-")[2]);o&&a.on(window,"load",(function(){var t=i.options.langPath+i.options.lang+"/images/";for(var e in o["static"]){var s=r(e);if(s){var c=s.tagName,l=o["static"][e];switch(l.src&&(l=n.extend({},l,!1),l.src=t+l.src),l.style&&(l=n.extend({},l,!1),l.style=l.style.replace(/url\s*\(/g,"url("+t)),c.toLowerCase()){case"var":s.parentNode.replaceChild(document.createTextNode(l),s);break;case"select":for(var u,d=s.options,h=0;u=d[h];)u.innerHTML=l.options[h++];for(var f in l)"options"!=f&&s.setAttribute(f,l[f]);break;default:a.setAttributes(s,l)}}}}))}})()},"7bcf":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},["dialog"===this.$route.query.fodder||"many"===this.$route.query.type?i("upload-from",{attrs:{isChoice:t.isChoiceD,gridPic:t.gridPic,gridBtn:t.gridBtn},on:{getPicD:t.getPicD}}):i("upload-from",{attrs:{isChoice:t.isChoice,gridPic:t.gridPic,gridBtn:t.gridBtn},on:{getPic:t.getPic}})],1)},a=[],n=i("b0e7"),r=(i("6bef"),{name:"widgetImg",components:{uploadFrom:n["a"]},data:function(){return{isChoice:"单选",isChoiceD:"多选",gridPic:{xl:4,lg:4,md:8,sm:12,xs:12},gridBtn:{xl:4,lg:4,md:4,sm:8,xs:8}}},mounted:function(){console.log(this.$route.query.fodder)},methods:{getPicD:function(t){if("dialog"===this.$route.query.fodder){for(var e="",i=0;i<t.length;i++)e+='<img src="'+t[i].att_dir+'">';nowEditor.dialog.close(!0),nowEditor.editor.setContent(e,!0)}else form_create_helper.set(this.$route.query.fodder,t),form_create_helper.close(this.$route.query.fodder)},getPic:function(t){form_create_helper.set(this.$route.query.fodder,t.satt_dir),form_create_helper.close(this.$route.query.fodder)}}}),o=r,c=(i("29fb"),i("2877")),l=Object(c["a"])(o,s,a,!1,null,"afb3bc1a",null);e["default"]=l.exports},b0e7:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"Modal"},[i("Row",{staticClass:"colLeft"},[i("Col",{staticClass:"colLeft",attrs:{xl:6,lg:6,md:6,sm:6,xs:24}},[i("div",{staticClass:"Nav"},[i("div",{staticClass:"input"},[i("Input",{staticStyle:{width:"90%"},attrs:{search:"","enter-button":"",placeholder:"选择分类"},on:{"on-search":t.changePage},model:{value:t.uploadName.name,callback:function(e){t.$set(t.uploadName,"name",e)},expression:"uploadName.name"}})],1),i("div",{staticClass:"trees-coadd"},[i("div",{staticClass:"scollhide"},[i("div",{staticClass:"trees"},[i("Tree",{ref:"tree",staticClass:"treeBox",attrs:{data:t.treeData,render:t.renderContent}})],1)])])])]),i("Col",{staticClass:"colLeft",attrs:{xl:18,lg:18,md:18,sm:18,xs:24}},[i("div",{staticClass:"conter"},[i("div",{staticClass:"bnt acea-row row-middle"},[i("Col",{staticClass:"mb10",attrs:{span:"24"}},[i("Button",{staticClass:"mr10",attrs:{type:"primary",disabled:0===t.checkPicList.length},on:{click:t.checkPics}},[t._v("使用选中图片")]),i("Upload",{staticClass:"mr10 mb10",staticStyle:{"margin-top":"1px",display:"inline-block"},attrs:{"show-upload-list":!1,action:t.fileUrl,"before-upload":t.beforeUpload,data:t.uploadData,headers:t.header,multiple:!0,"on-success":t.handleSuccess}},[i("Button",{attrs:{type:"primary"}},[t._v("上传图片")])],1),i("Button",{staticClass:"mr10",attrs:{type:"success"},on:{click:function(e){return e.stopPropagation(),t.add(e)}}},[t._v("添加分类")]),i("Button",{staticClass:"mr10",attrs:{type:"error",disabled:0===t.checkPicList.length},on:{click:function(e){return e.stopPropagation(),t.editPicList("图片")}}},[t._v("删除图片")]),i("i-select",{staticClass:"treeSel",staticStyle:{width:"160px"},attrs:{value:t.pids,placeholder:"图片移动至"}},[t._l(t.list,(function(e,s){return i("i-option",{key:s,staticStyle:{display:"none"},attrs:{value:e.value}},[t._v("\n                                "+t._s(e.title)+"\n                            ")])})),i("Tree",{ref:"reference",staticClass:"treeBox",attrs:{data:t.treeData2,render:t.renderContentSel}})],2)],1)],1),i("div",{staticClass:"pictrueList acea-row"},[i("Row",{staticClass:"conter",attrs:{gutter:24}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowPic,expression:"isShowPic"}],staticClass:"imagesNo"},[i("Icon",{attrs:{type:"ios-images",size:"60",color:"#dbdbdb"}}),i("span",{staticClass:"imagesNo_sp"},[t._v("图片库为空")])],1),i("div",{staticClass:"acea-row"},t._l(t.pictrueList,(function(e,s){return i("div",{key:s,staticClass:"pictrueList_pic mr10 mb10"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.satt_dir,expression:"item.satt_dir"}],class:e.isSelect?"on":"",on:{click:function(i){return i.stopPropagation(),t.changImage(e,s,t.pictrueList)}}})])})),0)])],1),i("div",{staticClass:"footer acea-row row-between-wrapper"},[i("Page",{attrs:{total:t.total,"show-elevator":"","show-total":"","page-size":t.fileData.limit},on:{"on-change":t.pageChange}})],1)])])],1)],1)},a=[],n=i("a34a"),r=i.n(n),o=i("b6bd");function c(t){return Object(o["a"])({url:"file/category",method:"get",params:t})}function l(t){return Object(o["a"])({url:"file/category/create",method:"get",params:t})}function u(t){return Object(o["a"])({url:"file/category/".concat(t,"/edit"),method:"get"})}function d(t){return Object(o["a"])({url:"file/file",method:"get",params:t})}function h(t){return Object(o["a"])({url:"file/file/do_move",method:"put",data:t})}var f=i("d708"),p=i("c276");function g(t){return y(t)||v(t)||m()}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function v(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function y(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function w(t,e,i,s,a,n,r){try{var o=t[n](r),c=o.value}catch(l){return void i(l)}o.done?e(c):Promise.resolve(c).then(s,a)}function b(t){return function(){var e=this,i=arguments;return new Promise((function(s,a){var n=t.apply(e,i);function r(t){w(n,s,a,r,o,"next",t)}function o(t){w(n,s,a,r,o,"throw",t)}r(void 0)}))}}var P={name:"uploadPictures",props:{isChoice:{type:String,default:""},gridBtn:{type:Object,default:null},gridPic:{type:Object,default:null}},data:function(){return{spinShow:!1,fileUrl:f["a"].apiBaseURL+"/file/upload",modalPic:!1,treeData:[],treeData2:[],pictrueList:[],uploadData:{},checkPicList:[],uploadName:{name:""},FromData:null,isShow:!1,treeId:0,isJudge:!1,buttonProps:{type:"default",size:"small"},fileData:{pid:0,page:1,limit:12},total:0,pids:0,list:[],modalTitleSs:"",isShowPic:!1,header:{},ids:[]}},mounted:function(){this.getToken(),this.getList(),this.getFileList()},methods:{getToken:function(){this.header["Authori-zation"]="Bearer "+p["a"].cookies.get("token")},renderContent:function(t,e){var i=this,s=e.root,a=e.node,n=e.data;return t("div",{style:{display:"inline-block",width:"90%"},on:{mouseenter:function(){i.onMouseOver(s,a,n)},mouseleave:function(){i.onMouseOver(s,a,n)}}},[t("span",[t("span",{style:{cursor:"pointer"},class:["ivu-tree-title"],on:{click:function(t){i.appendBtn(s,a,n,t)}}},n.title)]),t("span",{style:{display:"inline-block",float:"right"}},[t("Button",{props:Object.assign({},this.buttonProps,{icon:"ios-add"}),style:{marginRight:"8px",display:n.flag?"inline":"none"},on:{click:function(){i.append(s,a,n)}}}),t("Button",{props:Object.assign({},this.buttonProps,{icon:"md-create"}),style:{marginRight:"8px",display:n.flag?"inline":"none"},on:{click:function(){i.editPic(s,a,n)}}}),t("Button",{props:Object.assign({},this.buttonProps,{icon:"ios-remove"}),style:{display:n.flag?"inline":"none"},on:{click:function(){i.remove(s,a,n,"分类")}}})])])},renderContentSel:function(t,e){var i=this,s=e.root,a=e.node,n=e.data;return t("div",{style:{display:"inline-block",width:"90%"}},[t("span",[t("span",{style:{cursor:"pointer"},class:["ivu-tree-title"],on:{click:function(t){i.handleCheckChange(s,a,n,t)}}},n.title)])])},handleCheckChange:function(t,e,i,s){this.list=[];var a=i.id,n=i.title;this.list.push({value:a,title:n}),this.ids.length?(this.pids=a,this.getMove()):this.$Message.warning("请先选择图片");for(var r=this.$refs.reference.$el.querySelectorAll(".ivu-tree-title-selected"),o=0;o<r.length;o++)r[o].className="ivu-tree-title";s.path[0].className="ivu-tree-title  ivu-tree-title-selected"},getMove:function(){var t=this,e={pid:this.pids,images:this.ids.toString()};h(e).then(function(){var e=b(r.a.mark((function e(i){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$Message.success(i.msg),t.getFileList(),t.pids=0,t.checkPicList=[],t.ids=[];case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},editPicList:function(t){var e=this;this.tits=t;var i={ids:this.ids.toString()},s={title:"删除选中图片",url:"file/file/delete",method:"POST",ids:i};this.$modalSure(s).then((function(t){e.$Message.success(t.msg),e.getFileList(),e.checkPicList=[]})).catch((function(t){e.$Message.error(t.msg)}))},onMouseOver:function(t,e,i){event.preventDefault(),i.flag=!i.flag},appendBtn:function(t,e,i,s){this.treeId=i.id,this.getFileList();for(var a=this.$refs.tree.$el.querySelectorAll(".ivu-tree-title-selected"),n=0;n<a.length;n++)a[n].className="ivu-tree-title";s.path[0].className="ivu-tree-title  ivu-tree-title-selected"},append:function(t,e,i){this.treeId=i.id,this.getFrom()},remove:function(t,e,i,s){var a=this;this.tits=s;var n={title:"删除 [ "+i.title+" ] 分类",url:"file/category/".concat(i.id),method:"DELETE",ids:""};this.$modalSure(n).then((function(t){a.$Message.success(t.msg),a.getList(),a.checkPicList=[]})).catch((function(t){a.$Message.error(t.msg)}))},editPic:function(t,e,i){var s=this;this.$modalForm(u(i.id)).then((function(){return s.getList()}))},changePage:function(){this.getList()},getList:function(){var t=this,e={title:"全部图片",id:""};c(this.uploadName).then(function(){var i=b(r.a.mark((function i(s){return r.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.treeData=s.data.list,t.treeData.unshift(e),t.treeData2=g(t.treeData),t.addFlag(t.treeData);case 4:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},addFlag:function(t){var e=this;t.map((function(t){e.$set(t,"flag",!1),t.children&&e.addFlag(t.children)}))},add:function(){this.treeId=0,this.getFrom()},getFileList:function(){var t=this;this.fileData.pid=this.treeId,d(this.fileData).then(function(){var e=b(r.a.mark((function e(i){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.pictrueList=i.data.list,t.pictrueList.length?t.isShowPic=!1:t.isShowPic=!0,t.total=i.data.count;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},pageChange:function(t){this.fileData.page=t,this.getFileList(),this.checkPicList=[]},getFrom:function(){var t=this;this.$modalForm(l({id:this.treeId})).then((function(){return t.getList()}))},beforeUpload:function(){var t=this;this.uploadData={pid:this.treeId};var e=new Promise((function(e){t.$nextTick((function(){e(!0)}))}));return e},handleSuccess:function(t,e){200===t.status?(this.$Message.success(t.msg),this.getFileList()):this.$Message.error(t.msg)},cancel:function(){this.$emit("changeCancel")},changImage:function(t,e,i){var s=this,a="";this.$set(this.pictrueList[e],"isSelect",void 0===t.isSelect||!t.isSelect),a=this.pictrueList.filter((function(t){return!0===t.isSelect})),this.checkPicList=a,this.ids=[],this.checkPicList.map((function(t,e){s.ids.push(t.att_id)}))},checkPics:function(){if("单选"===this.isChoice){if(this.checkPicList.length>1)return this.$Message.warning("最多只能选一张图片");this.$emit("getPic",this.checkPicList[0])}else this.$emit("getPicD",this.checkPicList),console.log(this.checkPicList)}}},C=P,k=(i("248f"),i("2877")),L=Object(k["a"])(C,s,a,!1,null,"7678473a",null);e["a"]=L.exports},b26a:function(t,e,i){}}]);